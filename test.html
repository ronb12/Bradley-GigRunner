<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Test Page - Bradley GigRunner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="favicon.ico" />
  <link rel="manifest" href="manifest.json" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9fafb;
      padding: 20px;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      text-align: center;
    }
    .box {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      max-width: 500px;
      width: 100%;
    }
    h1 { color: #1a4d2e; margin-bottom: 20px; }
    .test-section {
      margin: 20px 0;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background: #f8f9fa;
    }
    .test-section h3 {
      color: #495057;
      margin-bottom: 15px;
    }
    button {
      width: 100%;
      padding: 12px;
      background: #1a4d2e;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin: 5px 0;
    }
    button:hover { background: #145032; }
    .btn-test { background: #17a2b8; }
    .btn-test:hover { background: #138496; }
    .btn-success { background: #28a745; }
    .btn-success:hover { background: #218838; }
    .btn-warning { background: #ffc107; color: #212529; }
    .btn-warning:hover { background: #e0a800; }
    .footer { font-size: 0.9em; margin-top: 20px; }
    .error-message { color: red; font-size: 0.9em; margin-top: 10px; }
    .success-message { color: #28a745; font-size: 0.9em; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="box">
    <h1>üß™ Test Page</h1>
    <p>Development and testing tools for Bradley GigRunner</p>
    
    <div class="test-section">
      <h3>Authentication Testing</h3>
      <button id="createTestUser" class="btn-test">Create Test User</button>
      <button id="testLogin" class="btn-success">Test Login</button>
      <button id="clearData" class="btn-warning">Clear Test Data</button>
    </div>
    
    <div class="test-section">
      <h3>Navigation Testing</h3>
      <button onclick="window.location.href='login.html'">Go to Login</button>
      <button onclick="window.location.href='signup.html'">Go to Signup</button>
      <button onclick="window.location.href='customer-dashboard.html'">Customer Dashboard</button>
      <button onclick="window.location.href='driver-dashboard.html'">Driver Dashboard</button>
      <button onclick="window.location.href='admin.html'">Admin Dashboard</button>
    </div>
    
    <div class="test-section">
      <h3>Firebase Testing</h3>
      <button id="testFirebase" class="btn-test">Test Firebase Connection</button>
      <button id="testAuth" class="btn-test">Test Authentication</button>
      <button id="testDatabase" class="btn-test">Test Database</button>
    </div>
    
    <div class="footer">
      <a href="index.html" style="color: #666; text-decoration: none;">‚Üê Back to Home</a>
    </div>
    
    <div id="errorMessage" class="error-message"></div>
    <div id="successMessage" class="success-message"></div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
    import { getFirestore, collection, addDoc, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBYJkHvoa43DbF5Wn_a8uGZ9o_olCMnuFc",
      authDomain: "bradley-gigrunner.firebaseapp.com",
      projectId: "bradley-gigrunner",
      storageBucket: "bradley-gigrunner.firebasestorage.app",
      messagingSenderId: "497753581430",
      appId: "1:497753581430:web:db6c22866194dd3285bc57"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth();

    function showMessage(message, isError = false) {
      const errorDiv = document.getElementById("errorMessage");
      const successDiv = document.getElementById("successMessage");
      
      if (isError) {
        errorDiv.innerText = message;
        errorDiv.style.display = "block";
        successDiv.style.display = "none";
      } else {
        successDiv.innerText = message;
        successDiv.style.display = "block";
        errorDiv.style.display = "none";
      }
    }

    // Create test user
    document.getElementById('createTestUser').addEventListener('click', async () => {
      try {
        const testEmail = "test@bradleygigrunner.com";
        const testPassword = "test123456";
        
        const userCredential = await createUserWithEmailAndPassword(auth, testEmail, testPassword);
        
        await addDoc(collection(db, "users"), {
          uid: userCredential.user.uid,
          email: testEmail,
          roles: ["customer"],
          createdAt: new Date(),
          profile: {
            name: 'Test User',
            phone: '',
            address: ''
          }
        });
        
        showMessage("‚úÖ Test user created successfully!");
      } catch (error) {
        if (error.code === 'auth/email-already-in-use') {
          showMessage("‚úÖ Test user already exists!");
        } else {
          showMessage("‚ùå Error: " + error.message, true);
        }
      }
    });

    // Test login
    document.getElementById('testLogin').addEventListener('click', async () => {
      try {
        const userCredential = await signInWithEmailAndPassword(auth, "test@bradleygigrunner.com", "test123456");
        showMessage("‚úÖ Login successful! User: " + userCredential.user.email);
      } catch (error) {
        showMessage("‚ùå Login failed: " + error.message, true);
      }
    });

    // Test Firebase connection
    document.getElementById('testFirebase').addEventListener('click', () => {
      try {
        showMessage("‚úÖ Firebase connection successful! Project: " + firebaseConfig.projectId);
      } catch (error) {
        showMessage("‚ùå Firebase connection failed: " + error.message, true);
      }
    });

    // Test authentication
    document.getElementById('testAuth').addEventListener('click', () => {
      const user = auth.currentUser;
      if (user) {
        showMessage("‚úÖ User is authenticated: " + user.email);
      } else {
        showMessage("‚ÑπÔ∏è No user currently authenticated");
      }
    });

    // Test database
    document.getElementById('testDatabase').addEventListener('click', async () => {
      try {
        const testDoc = await getDoc(doc(db, "users", "test"));
        showMessage("‚úÖ Database connection successful!");
      } catch (error) {
        showMessage("‚ùå Database test failed: " + error.message, true);
      }
    });

    // Clear test data
    document.getElementById('clearData').addEventListener('click', async () => {
      try {
        await signOut(auth);
        showMessage("‚úÖ Test data cleared! User signed out.");
      } catch (error) {
        showMessage("‚ùå Error clearing data: " + error.message, true);
      }
    });
  </script>
</body>
</html>
